<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Image Annotation</title>
  <!-- 引入自定义 CSS 文件 -->
  <link rel="stylesheet" href="{% static 'css/bar.css' %}">
  <link rel="stylesheet" href="{% static 'css/body.css' %}">
  <link rel="stylesheet" href="{% static 'css/imgae_show.css' %}">
  <!-- 引入 Font Awesome 图标库 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- 引入 Bootstrap CSS -->
  <link href="https://cdn.staticfile.net/twitter-bootstrap/5.1.1/css/bootstrap.min.css" rel="stylesheet">
  <!-- 引入 jQuery 库 -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- 引入 Bootstrap JavaScript -->
  <script src="https://cdn.staticfile.net/twitter-bootstrap/5.1.1/js/bootstrap.bundle.min.js"></script>
  <style>
    /* 顶部区域样式 */
    #top-half {
      height: 250px;
      width: 1200px;
      background-color:white;
      border-radius: 10px;
      border: 1px solid #ccc;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      margin: 200px auto 0;
      display: flex;
      align-items: center;
      justify-content: space-around;
    }

    /* 头像区域样式 */
    #avatar-section {
      text-align: center;
    }

    #avatar-section img {
      width: 300px;
      height: 300px;
      border-radius: 50%;
    }

    #avatar-section button {
      margin-top: 20px;
      background-color: #aaa;
      border-color: #666;
    }

    /* 用户名区域样式 */
    #username-section {
      text-align: center;
    }

    #username-section h1 {
      margin: 0;
    }

    /* 图片容器样式 */
    #bottom-half {
      margin-top: 50px;
      text-align: center;
    }

    #bottom-half h2 {
      margin-bottom: 20px;
    }

   .image-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

  .image-item {
      margin: 10px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

  .image-item:hover {
      transform: scale(1.1);
    }

    /* 全屏图片样式 */
   .fullscreen-img {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

  .fullscreen-img.active {
      display: flex;
    }

  .fullscreen-img img {
      max-width: 90%;
      max-height: 90%;
    }
  </style>
</head>

<body>
  <!-- 背景粒子特效 iframe -->
  <iframe src="./static/html_material/particle-background.html" frameborder="0" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;"></iframe>

  <!-- 侧边栏导航 -->
  <div class="sidebar">
    <a href="/backtohome"><i class="fas fa-home"></i> 返回首页</a><br>
    <a href="/materials"><i class="fas fa-archive"></i> 查看未标注的图片</a><br>
    <a href="/ku"><i class="fas fa-robot"></i> 查看模型标注的图片</a><br>
    <a href="/tonopredpicture"><i class="fas fa-desktop"></i> 查看模型标注原始图片</a><br>
    <a href="/annotated_images_ku"><i class="fas fa-user-friends"></i> 查看人工标注的图片</a><br>
    <a href="/self"><i class="fas fa-user-circle"></i> 查看个人主页</a><br>
  </div>

  <!-- 顶部区域 -->
  <div id="top-half">
    <!-- 头像部分 -->
    <div id="avatar-section">
      <img src="http://127.0.0.1:5000/static/head/{{ head }}" alt="头像">
      <form id="upload_form" action="/upload_head" method="post" enctype="multipart/form-data" style="display: none;">
        <input type="file" id="head_upload" name="head_upload">
      </form>
      <button class="btn btn-primary" id="choose_file_button">修改头像</button>
    </div>
    <!-- 用户名部分 -->
    <div id="username-section">
      <h1>用户名: {{username}}</h1>
    </div>
  </div>

  <!-- 底部区域 -->
  <div id="bottom-half">
    <h2>已标注的图像: {{user_images_num}}</h2>
    <div class="image-container">
      {% for image in images %}
      <div class="image-item" onclick="openFullscreen('{{ image }}')">
        <img src="http://127.0.0.1:5000/static/annotationimages/{{ image }}" alt="{{ image }}">
      </div>
      {% endfor %}
    </div>
  </div>

  <!-- 全屏图片容器 -->
  <div class="fullscreen-img" id="fullscreenImg">
    <img id="fullscreenImgContent" src="" alt="">
  </div>

  <script>
    // 打开全屏图片函数
    function openFullscreen(imageUrl) {
      document.getElementById('fullscreenImgContent').src = 'http://127.0.0.1:5000/static/annotationimages/' + imageUrl;
      document.getElementById('fullscreenImg').classList.add('active');
    }

    // 点击全屏图片容器关闭全屏
    document.getElementById('fullscreenImg').addEventListener('click', function () {
      document.getElementById('fullscreenImg').classList.remove('active');
    });

    // 点击修改头像按钮触发文件选择
    document.getElementById('choose_file_button').addEventListener('click', function () {
      document.getElementById('head_upload').click();
    });

    // 文件选择后提交表单
    document.getElementById('head_upload').addEventListener('change', function () {
      document.getElementById('upload_form').submit();
    });
  </script>
</html>